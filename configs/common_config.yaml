seed: 42
device: "cuda:0"
train:
  epochs: 1000
  batch:
    n_f: 4096
    n_b: 1024
    n_0: 1024
  optimizer:
    name: adam
    lr: 5.0e-4  # Lower for stability with transformers
    weight_decay: 1.0e-5
  early_stopping:
    enabled: false
    patience: 10000
    min_delta: 0
  loss_weights:
    res: 0.5 # 0.5
    bc: 20.0 # 0.0  # Increased weight for boundary conditions
    ic: 0
  loss_balancer:
    use_loss_balancer: true
    kind: dwa
    terms: [res, bc]  # No IC for steady state
    alpha: 0.15
    gamma: 0.5
    update_every: 20
    ref_layer_name: "head.weight"
log:
  out_dir: "outputs"
  wandb:
    enabled: true
    project: "pinnlab_patch"
    entity: null
    mode: "online"
eval:
  grid:
    nx: 201
    ny: 201
    nt: 100
  every: 1000
gradflow:
  enabled: false
  every: 500
  store_vectors: true
  wandb_hist: false
  max_keep: 20
  stop_at: 10000
  plot:
    enabled: true
    kde: true
    stats: true
    losses: ["bc", "res"]
    loss_kde: true
    loss_kde_filename: "gradflow_kde_losses.png"
    kde_filename: "gradflow_kde.png"
    stats_prefix: "gradflow_stats"
    max_cols: 4